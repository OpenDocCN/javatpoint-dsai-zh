# 集中 Excel 文件元数据

> 原文:[https://www . javatpoint . com/talend-集中化-excel-文件-元数据](https://www.javatpoint.com/talend-centralizing-excel-file-metadata)

在本节中，我们将学习如何在 Talend Studio 数据集成平台中集中 Excel 文件元数据。

在本章继续之前，我们先了解一下为什么要使用 Excel 文件。

如果我们想要连接到一个 Excel 文件，我们将在存储库中集中连接和模式信息，以实现重用。

要从一开始就创建 Excel 文件连接:

*   转到**存储库面板。**
*   然后展开**元数据**，右键点击**文件 Excel** ，在弹出菜单中选择**创建文件 Excel** 选项，如下图所示:

**存储库→元数据→文件 Excel →创建文件 Excel**

![Centralizing Excel File Metadata](../Images/a5e379ecb158c32848fc18023a9a0b75.png)

#### 注意:要在我们的工作中使用集中式 Excel 文件，请转到必要组件的基本设置视图，其属性类型设置为打开文件元数据设置窗口的内置选项。

然后**新建 Excel 文件**窗口将打开，文件连接和模式定义分四步完成:

*   **定义常规属性**
*   **定义文件路径和格式**
*   **定义文件解析参数**
*   **检查和定制文件模式**

**步骤 1:定义一般属性**

在第一步中，我们将填写所有必要的细节，如**名称、目的和描述。**

我们还可以在**项目设置**对话框中管理**版本**和**状态**字段。

点击路径字段旁边的**选择**按钮，选择**文件 Excel** 节点下的文件夹，保存我们新创建的文件连接。

#### 注意:如果我们正在编辑一个现有的连接，我们不能选择一个文件夹，但是我们可以随时将它拖放到一个新的文件夹中。

填写完所有通用属性的详细信息后，点击**下一步**按钮。

![Centralizing Excel File Metadata](../Images/73e8f9db28c699497e1f0903a6ff42eb.png)

**第二步:定义文件路径和格式**

下一步，我们将点击**浏览**按钮，从本地系统中定位我们的文件。

#### 注意:如果我们保存的是组件中定义的 excel 文件连接，文件路径将自动出现在文件字段中。

例如，我们将从系统中选择 **New_Excel.xlsx** 文件。

*   如果上传的文件是 excel2007 文件，确保选择了**读取 Excel 2007 文件格式(xlsx)** 复选框。
*   如果上传的 xlsx 文件非常大，则从生成模式列表中选择**大 excel 消耗内存少(事件模式)**，停止内存不足错误；否则，默认选择**内存消耗(用户模式)**。
*   我们有**文件查看器和工作表设置区**，在这里我们可以看到文件内容和一个或多个工作表。
*   我们可以从**请选择工作表**下拉列表中选择想要查看的工作表，**预览表**显示所选工作表的内容。

#### 注意:默认情况下，文件预览表显示文件的第一页。

*   我们也可以从**设置纸张参数**中选择一张或多张要上传的纸张
*   如果我们选择一个以上的工作表，结果模式将代表所有选定工作表的结构组合。

![Centralizing Excel File Metadata](../Images/278473d11cf5a1fc05d7ef0031cffcd1.png)

*   之后，点击**下一步**按钮进行进一步处理。

**步骤 3:文件解析参数**

在这一步中，我们将描述文件解析的多个设置，以正确恢复文件模式。

*   在**文件设置**区域，我们可以根据上传的文件设置**编码**类型。
*   在**要跳过的行**部分，如果 Excel 文件有页眉或页脚，我们可以跳过该行，如下图所示:

![Centralizing Excel File Metadata](../Images/65ca00cbbbfdbec4e780338abde104f4.png)

*   **元数据列设置**区域代表列，必须通过用整数填充**第一列**和**最后一列**字段来读取文件中的列。
    **例如:**如果我们想跳过第一列，因为它可能没有正确的数据，需要处理，在**第一列**中放 2，并将文件的第二列设置为模式的第一列。
    但是在我们的例子中，我们在**第一列**中放入 1，如下图所示:

![Centralizing Excel File Metadata](../Images/69fb045238394e42d37427adca245d0a.png)

*   我们不需要解析文件的所有行，主要是当我们在检索 Excel 文件的模式时上传了一个大文件。我们可以通过选择**行数限制**部分的**限制**复选框来设置所需的行数。

![Centralizing Excel File Metadata](../Images/960ff5c6dd413d077b37f97c1cebb6c8.png)

*   如果我们的 excel 文件有标题行，选择**将处理行设置为列名**复选框以考虑标题名。
*   要查看效果和结果视图，在查看器上，点击**刷新预览**按钮，如下图所示:

![Centralizing Excel File Metadata](../Images/10cf2ddb81a3a8564406bc4270473f85.png)

然后，点击**下一步**按钮。

**步骤 4:检查和定制文件模式**

在最后一步中，我们将检查并定制文件模式。

*   要自定义文件模式，请检查**类型**列中的数据类型是否正确。
*   **猜测**按钮用于更新和恢复 Excel 文件模式。

#### 注意:如果我们已经定制了模式，那么 Guess 特性不会保留这些更改。

*   之后，点击**完成**按钮完成该过程，如下图所示:

![Centralizing Excel File Metadata](../Images/2a011d2dc6ec48fec01a9f4d3548ef82.png)

要在 Talend 工作室中查看新创建的元数据:

*   转到**存储库面板，**然后转到元数据。
*   之后，展开**文件 Excel** 节点，选择 **New_excel** 元数据，如下图截图所示:

**存储库→元数据→文件 Excel → New_excel**

![Centralizing Excel File Metadata](../Images/e90735118582fc1388c1889278c2b820.png)

要将元数据作为新组件或现有组件重用，只需将文件连接或模式从存储库的元数据节点拖放到设计工作区窗口。

要修改现有的文件连接:

*   转到**存储库面板**，然后转到**元数据节点**。
*   之后，展开**文件 Excel，**右键点击模式，选择**编辑文件 Excel** ，如下图所示:

![Centralizing Excel File Metadata](../Images/bc8642070040b293acedf3b777333620.png)

要向现有文件连接添加新模式，请执行以下操作:

*   转到**存储库面板**，右键点击**文件 Excel** 。
*   从**元数据**的弹出菜单中选择**检索模式**，如下图所示:

![Centralizing Excel File Metadata](../Images/a96000afd803509d48dd19b35f515c93.png)

* * *